本文讲的是Winrar漏洞利用脚本的使用方法，至于Winrar漏洞的原理，请移步——> [Winrar目录穿越漏洞复现](https://www.cnblogs.com/backlion/p/10417985.html "Winrar目录穿越漏洞复现")

本次利用脚本出处——> [GitHub - backlion/CVE-2018-20250: exp for https://research.checkpoint.com/extracting-code-execution-from-winrar](https://github.com/backlion/CVE-2018-20250 "GitHub - backlion/CVE-2018-20250: exp for https://research.checkpoint.com/extracting-code-execution-from-winrar")

下载完该脚本后，解压，我们会得到下面这些文件。calc.exe可以替换成我们的[木马](https://so.csdn.net/so/search?q=%E6%9C%A8%E9%A9%AC&spm=1001.2101.3001.7020)文件，hello.txt和world.txt则是压缩包中的文件，我们也可以自行替换。但是要注意的是，替换的时候，名字要和原来的一样。

![](https://img-blog.csdnimg.cn/20190428134038979.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2MTE5MTky,size_16,color_FFFFFF,t_70)

如果我们想修改这些名字的话，我们可以打开exp.py，然后修改下面内容。这里我们保持默认不修改。

![](https://img-blog.csdnimg.cn/20190428134312744.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2MTE5MTky,size_16,color_FFFFFF,t_70)

生成木马压缩文件：**python  exp.py**

这里是python3环境，如果运行出错，提示未安装库包的话，则安装相应的库包即可！

![](https://img-blog.csdnimg.cn/20190428134635653.png)

可以看到，在当前文件夹内生成了test.rar压缩文件。

![](https://img-blog.csdnimg.cn/20190428134759196.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2MTE5MTky,size_16,color_FFFFFF,t_70)

只要将该压缩文件发给其他用户，其他用户的电脑中存在winrar漏洞的话，那么当他解压缩后，会在电脑启动目录放入我们的木马文件 hi.exe。

![](https://img-blog.csdnimg.cn/20190428135718424.png)

注意：这里其他用户解压我们文件的时候有要求，也就是他解压的目录必须是 C:/users/当前用户/  目录下，也就是必须是在下面这些目录中解压的该文件。

![](https://img-blog.csdnimg.cn/20190428143339316.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2MTE5MTky,size_16,color_FFFFFF,t_70)

  如果想跟我一起讨论的话，就快加入我的知识星球吧。星球里有一千多位同样爱好安全技术的小伙伴一起交流！

![](https://img-blog.csdnimg.cn/1219ed79e9ed449d85d27b732cda5ea6.jpg)