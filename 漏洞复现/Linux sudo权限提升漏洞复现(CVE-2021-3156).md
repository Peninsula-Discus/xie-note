**目录**

[漏洞背景](#t0 "漏洞背景")

[漏洞影响版本](#t1 "漏洞影响版本")

[漏洞检测](#t2 "漏洞检测")

[漏洞复现](#t3 "漏洞复现")

[漏洞修复](#t4 "漏洞修复")

* * *

### 漏洞背景

1月26日，Sudo发布安全通告，修复了一个类[Unix操作系统](https://so.csdn.net/so/search?q=Unix%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F&spm=1001.2101.3001.7020)在命令参数中转义反斜杠时存在基于堆的缓冲区溢出漏洞。当sudo通过 -s 或 -i 命令行选项在shell模式下运行命令时，它将在命令参数中使用反斜杠转义特殊字符。但使用 -s 或 -i 标志运行 sudoedit 时，实际上并未进行转义，从而可能导致缓冲区溢出。因此只要存在sudoers文件（通常是 /etc/sudoers），攻击者就可以使用本地普通用户利用sudo获得系统root权限。目前漏洞细节已公开，请受影响的用户尽快采取措施进行防护。

相关文章：[Linux中su和sudo的用法和区别](https://xie1997.blog.csdn.net/article/details/99710793 "Linux中su和sudo的用法和区别")

### 漏洞影响版本

*   Sudo 1.8.2 - 1.8.31p2
*   Sudo 1.9.0 - 1.9.5p1

不受影响版本：sudo =>1.9.5p2

### 漏洞检测

查看sudo版本

```
sudo --version
```


![](https://img-blog.csdnimg.cn/20210131111746434.png)

检测是否存在漏洞，使用普通用户执行下面的命令

```
sudoedit -s /
```


*   若返回如图以“ sudoedit：”开头的错误，则当前系统可能存在安全风险。
*   不受影响的系统将显示以“ usage：”开头的错误

![](https://img-blog.csdnimg.cn/20210131142344434.png)

### 漏洞复现

此次使用的是kali，sudo版本为：1.8.27。漏洞poc：[https://haxx.in/CVE-2021-3156\_nss\_poc\_ubuntu.tar.gz](https://haxx.in/CVE-2021-3156_nss_poc_ubuntu.tar.gz "https://haxx.in/CVE-2021-3156_nss_poc_ubuntu.tar.gz")

```
tar -xvzf CVE-2021-3156_nss_poc_ubuntu.tar.gz      
cd CVE-2021-3156/      
make &&./sudo-hax-me-a-sandwich 0
```


![](https://img-blog.csdnimg.cn/20210131141212939.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2MTE5MTky,size_16,color_FFFFFF,t_70)

### 漏洞修复

目前官方已在sudo新版本1.9.5p2中修复了该漏洞，请受影响的用户尽快升级版本进行防护，官方下载链接：https://www.sudo.ws/download.html

注：建议用户在升级前做好数据备份工作，避免出现意外

  如果想跟我一起讨论的话，就快加入我的知识星球吧。星球里有一千多位同样爱好安全技术的小伙伴一起交流！

![](https://img-blog.csdnimg.cn/1219ed79e9ed449d85d27b732cda5ea6.jpg)

参考文章：[【漏洞通告】Linux sudo权限提升漏洞（CVE-2021-3156）](https://mp.weixin.qq.com/s/h4gKOXWFBI3K0RVSSmTPNw "【漏洞通告】Linux sudo权限提升漏洞（CVE-2021-3156） ") 

                   [【漏洞复现】CVE-2021-3156漏洞复现](https://mp.weixin.qq.com/s/tQ0UYm61MngYCI1_KcrsxA "【漏洞复现】CVE-2021-3156漏洞复现 ") 

文章知识点与官方知识档案匹配，可进一步学习相关知识

[CS入门技能树](https://edu.csdn.net/skill/gml/gml-1c31834f07b04bcc9c5dff5baaa6680c)[Linux入门](https://edu.csdn.net/skill/gml/gml-1c31834f07b04bcc9c5dff5baaa6680c)[初识Linux](https://edu.csdn.net/skill/gml/gml-1c31834f07b04bcc9c5dff5baaa6680c)10949 人正在系统学习中