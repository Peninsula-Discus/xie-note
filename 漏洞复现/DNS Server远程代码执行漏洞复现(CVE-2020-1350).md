**目录**

[漏洞描述](#t0)

[漏洞影响版本](#t1)

[漏洞复现](#t2)

[漏洞修复](#t3)

* * *

漏洞描述
----

    2020年7月15日，微软发布补丁修复了一个标注为远程代码执行的DNS Server漏洞，官方分类为“可蠕虫级”高危漏洞，易受攻击的漏洞有可能通过恶意软件在易受攻击的计算机之间传播，而无需用户干预。CVSS评分10分（即高危且易利用），漏洞编号CVE-2020-1350。未经身份验证的攻击者可以发送特殊构造的数据包到目标DNS Server来利用此漏洞，成功利用此漏洞可能达到远程代码执行的效果。如果[域控制器](https://so.csdn.net/so/search?q=%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8&spm=1001.2101.3001.7020)上存在DNS服务，攻击者可利用此漏洞获取到域控制器的系统权限。另外，DNS服务器一旦被控制，会存在域名劫持风险。

漏洞影响版本
------

以下版本启用DNS服务的系统受影响

*   _Windows Server 2008 for 32-bit Systems Service Pack 2_
*   _Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core)_
*   _Windows Server 2008 for x64-based Systems Service Pack 2_
*   _Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core)_        
*   _Windows Server 2008 for 32-bit Systems Service Pack 2_
*   _Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core)_
*   _Windows Server 2008 for x64-based Systems Service Pack 2_
*   _Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core)_
*   _Windows Server 2008 R2 for x64-based Systems Service Pack 1_
*   _Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core)_        
*   _Windows Server 2008 R2 for x64-based Systems Service Pack 1_
*   _Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core)_        
*   _Windows Server 2012_
*   _Windows Server 2012 (Server Core)_        
*   _Windows Server 2012_
*   _Windows Server 2012 (Server Core)_        
*   _Windows Server 2012 R2_
*   _Windows Server 2012 R2 (Server Core)_        
*   _Windows Server 2012 R2_
*   _Windows Server 2012 R2 (Server Core)_        
*   _Windows Server 2016_
*   _Windows Server 2016 (Server Core)_        
*   _Windows Server 2019_
*   _Windows Server 2019 (Server Core)_
*   _Windows Server, version 1903 (Server Core)_
*   _Windows Server, version 1909 (Server Core)_
*   _Windows Server, version 2004 (Server Core)_

漏洞复现
----

![](https://img-blog.csdnimg.cn/20210303204945720.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2MTE5MTky,size_16,color_FFFFFF,t_70)

[https://github.com/chompie1337/SIGRed\_RCE\_PoC](https://github.com/chompie1337/SIGRed_RCE_PoC)

漏洞修复
----

**临时缓解措施**

通过注册表编辑器，限制tcp包的长度

```
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\DNS\Parameters  DWORD = TcpReceivePacketSize  Value = 0xFF00
```


然后，重启DNS服务生效。

参考文章：[https://mp.weixin.qq.com/s/tK-V515sOS4WvcKp4yfnNQ](https://mp.weixin.qq.com/s/tK-V515sOS4WvcKp4yfnNQ)